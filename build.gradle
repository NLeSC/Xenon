plugins {
    // ide
    id 'idea'
    id 'eclipse'
    // publishing
    id 'com.jfrog.bintray' version '1.8.0' apply false
    // code style
    id 'com.diffplug.gradle.spotless' version '3.8.0' apply false
    // license
    id 'com.github.hierynomus.license' version '0.14.0' apply false

    id 'org.unbroken-dome.test-sets' version '1.4.2'

//    id 'com.github.johnrengelman.plugin-shadow' version '2.0.4' apply false
    id 'com.github.johnrengelman.shadow' version '2.0.4'apply false
}

description = 'Xenon: a middleware abstraction library that provides a simple programming interface to various compute and storage resources.'

allprojects {
    apply from: "${rootProject.rootDir}/gradle/common.gradle"
}

sourceSets {
    docGenerator
    liveTests
}

configurations {
    docGeneratorCompile.extendsFrom compile
    docGeneratorRuntime.extendsFrom runtime
}

testSets {
    liveTest {
        options {
            // Pass all -D arguments from gradlew to tests
            systemProperties(System.getProperties())
        }
    }
}

dependencies {
    // Xenon dependencies.
//    compile group: 'org.apache.jclouds.api', name: 's3', version: '2.0.2'
//    compile group: 'org.apache.jclouds.provider', name: 'aws-s3', version: '2.0.2'

//    compile group: 'org.apache.hadoop', name: 'hadoop-hdfs', version: '2.8.1'
//    compile group: 'org.apache.hadoop', name: 'hadoop-common', version: '2.8.1'

    // compile group: 'org.apache.sshd', name: 'sshd-core', version: '1.6.0'
//    compile group: 'com.github.NLeSC.mina-sshd', name: 'sshd-core', version: 'known-host-hash-with-port-1.6.0-SNAPSHOT'
//    compile group: 'org.apache.mina', name: 'mina-core', version: '2.0.7'
//    compile group: 'net.i2p.crypto', name: 'eddsa', version: '0.2.0'
//    compile group: 'commons-net', name: 'commons-net', version: '3.3'

//    compile group: 'org.slf4j', name: 'slf4j-api', version: '1.7.5'
//    compile group: 'com.github.lookfirst', name: 'sardine', version: '5.7'
//    compile group: 'joda-time', name: 'joda-time', version: '2.8.1'

    compile project(':core')

    compile project(path: 'adaptor-local', configuration: 'shadow')
    compile project(path: 'adaptor-ssh', configuration: 'shadow')
    compile project(path: 'adaptor-ftp', configuration: 'shadow')
    compile project(path: 'adaptor-webdav', configuration: 'shadow')
    compile project(path: 'adaptor-s3', configuration: 'shadow')
    compile project(path: 'adaptor-hdfs', configuration: 'shadow')
    compile project(path: 'adaptor-slurm', configuration: 'shadow')
    compile project(path: 'adaptor-gridengine', configuration: 'shadow')
    compile project(path: 'adaptor-torque', configuration: 'shadow')
    compile project(path: 'adaptor-gridftp', configuration: 'shadow')

    // Runtime dependencies
    runtime group: 'ch.qos.logback', name: 'logback-core', version: '1.0.11'
    runtime group: 'ch.qos.logback', name: 'logback-classic', version: '1.0.11'
//    runtime group: 'org.apache.hadoop', name: 'hadoop-client-runtime', version: '3.0.0'

    liveTestCompile project(':test-utils')
    liveTestCompile group: 'junit', name: 'junit', version: '4.12'
}

task wrapper(type: Wrapper) {
    description 'Generates gradle wrapper'
    group 'Build Setup'
    gradleVersion = '4.5'
}

publishing {
    publications {
        MyPublication(MavenPublication) {
            from components.java
            groupId 'nl.esciencecenter.xenon'
            artifactId 'xenon'
            version version
            artifact javadocJar
        }
    }
}

apply from: 'gradle/documentation.gradle'

apply from: 'gradle/site.gradle'

apply from: 'gradle/live.gradle'
